orig_train <- read.csv("titantic_data/original_files/train.csv")
View(orig_train)
orig_test <- read.csv("titantic_data/original_files/test.csv")
View(orig_test)
gender_sub <- read.csv("titantic_data/original_files/gender_submission.csv")
View(gender_sub)
set.seed(1977)
summary(orig_train)
plot(summary(orig_train))
require(dplyr)
train_age_complete <- orig_train %>%
filter(!is.na(Age))
View(train_age_complete)
summary(train_age_complete)
require(caret)
set.seed(1977)
samp_age <- sample(nrow(train_age_complete), 0.7)
samp_age <- sample(nrow(train_age_complete), 0.7)
samp_age
samp_age_train <- sample_frac(train_age_complete, size = 0.7, replace = FALSE)
samp_age_train
createDataPartition(train_age_complete, p = 0.7, list = FALSE)
samp_age_train <- sample_frac(train_age_complete$PassengerId, size = 0.7, replace = FALSE)
createDataPartition(y = train_age_complete, p = 0.7, list = FALSE)
createDataPartition(y = train_age_complete$PassengerId, p = 0.7, list = FALSE)
samp <- createDataPartition(y = train_age_complete$PassengerId, p = 0.7, list = FALSE)
samp_age_train <- train_age_complete[samp, ]
samp_age_test <- train_age_complete[-samp, ]
View(samp_age_train)
View(samp_age_test
View(samp_age_test)
View(samp_age_test)
age_model <- train(Age ~., data = samp_age_train, method = "pls")
age_model <- train(Age ~., data = samp_age_train, method = "pls")
summary(age_model)
age_model
samp_age_test$Age2 <- predict(age_model, newdata = samp_age_test)
samp_age_test$Age2
samp_age_test$Age2 <- round(predict(age_model, newdata = samp_age_test), 0)
samp_age_test$Age2
View(samp_age_test %>% select(Age, Age2))
samp_age_test$Delta2 <- samp_age_test$Age - samp_age_test$Age2
View(samp_age_test %>% select(Age, Age2, Delta2))
samp_age_test$Delta2 <- abs(samp_age_test$Age - samp_age_test$Age2)
View(samp_age_test %>% select(Age, Age2, Delta2))
mean(samp_age_test$Delta2)
median(samp_age_test$Delta2)
summary(samp_age_test$Delta2)
age_model <- train(Age ~., data = samp_age_train, method = "rf")
summary(age_model)
samp_age_test$Age3 <- round(predict(age_model, newdata = samp_age_test), 0)
samp_age_test$Delta3 <- abs(samp_age_test$Age - samp_age_test$Age3)
View(samp_age_test %>% select(Age, Age3, Delta3))
summary(samp_age_test$Delta3)
summary(samp_age_test$Delta2)
confusionMatrix(samp_age_test$Age, samp_age_test$Age2)
confusionMatrix(samp_age_test$Age, samp_age_test$Age3)
# Build age predictor using rpart decision tree method
age_model <- train(Age ~., data = samp_age_train, method = "rpart")
summary(age_model)
samp_age_test$Age4 <- round(predict(age_model, newdata = samp_age_test), 0)
samp_age_test$Delta4 <- abs(samp_age_test$Age - samp_age_test$Age4)
View(samp_age_test %>% select(Age, Age4, Delta4))
summary(samp_age_test$Delta4)
summary(samp_age_test$Delta3)
confusionMatrix(samp_age_test$Age, samp_age_test$Age4)
# Build age predictor using rpart decision tree method
age_model <- train(Age ~., data = samp_age_train, method = "repeatedcv")
summary(age_model)
summary(age_model)
samp_age_test$Age5 <- round(predict(age_model, newdata = samp_age_test), 0)
samp_age_test$Delta5 <- abs(samp_age_test$Age - samp_age_test$Age5)
View(samp_age_test %>% select(Age, Age5, Delta5))
summary(samp_age_test$Delta5)
res <- rbind(summary(samp_age_test$Delta2), summary(samp_age_test$Delta3))
res
res <- rbind(summary(samp_age_test$Delta2), summary(samp_age_test$Delta3), summary(samp_age_test$Delta4), summary(samp_age_test$Delta5))
res
sum1 <- summary(samp_age_test$Delta2)
sum2 <- summary(samp_age_test$Delta2)
sum3 <- summary(samp_age_test$Delta3)
sum4 <- summary(samp_age_test$Delta4)
sum5 <- summary(samp_age_test$Delta5)
age_model <- train(Age ~., data = samp_age_train, method = "rpart")
samp_age_test$Age4 <- round(predict(age_model, newdata = samp_age_test), 0)
samp_age_test$Delta4 <- abs(samp_age_test$Age - samp_age_test$Age4)
View(samp_age_test %>% select(Age, Age4, Delta4))
sum4 <- summary(samp_age_test$Delta4)
age_model <- train(Age ~., data = samp_age_train, method = "repeatedcv")
samp_age_test$Age5 <- round(predict(age_model, newdata = samp_age_test), 0)
samp_age_test$Delta5 <- abs(samp_age_test$Age - samp_age_test$Age5)
View(samp_age_test %>% select(Age, Age5, Delta5))
sum5 <- summary(samp_age_test$Delta5)
res <- rbind(sum2, sum3, sum4, sum5)
View(res)
age_model <- train(Age ~., data = samp_age_train, method = "repeatedcv")
age_model <- train(Age ~., data = samp_age_train, method = "cv")
age_model <- train(Age ~., data = samp_age_train, method = "boot")
age_model <- train(Age ~., data = samp_age_train, method = "blackboost")
